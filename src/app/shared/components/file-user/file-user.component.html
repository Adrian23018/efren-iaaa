<p-dialog [(visible)]="showFileDialog" [modal]="true" [style]="{ width: '90vw', maxWidth: '900px' }"
    [dismissableMask]="true" [breakpoints]="{ '960px': '95vw', '640px': '100vw' }" [closeOnEscape]="true"
    [draggable]="false" [header]="'Expediente'" (onHide)="closeFileDialog()">

    <div class="flex justify-content-between align-items-center mb-3">
        <div class="flex flex-column">
            <p class="text-color-secondary mt-0">Revisa los expedientes y conversaciones del usuario</p>
        </div>
        <div class="flex gap-2">

        </div>
    </div>


    <div class="grid">
        <div class="col-12 md:col-12" *ngIf="selectedFile.id else noFileSelected">
            <p-card styleClass="h-full">
                <ng-template pTemplate="title">
                    <div class="flex justify-content-between align-items-start">
                        <div>
                            <h2 class="text-lg font-semibold m-0">{{ selectedFile.user_name }} -
                                <span class="px-2 py-0 text-sm font-medium border-round" [ngClass]="{
                                    'bg-green-100 text-green-700': selectedFile.name === 'Plan Elite',
                                    'bg-blue-100 text-blue-700': selectedFile.name === 'Plan Pro',
                                    'bg-gray-200 text-gray-700': selectedFile.name === 'Plan Demo'
                                  }">{{ selectedFile.name }}</span>

                            </h2>
                            <p class="text-color-secondary text-sm m-0">Expediente #{{ selectedFile.id }} • Usuario ID
                                #{{ selectedFile.userId }}</p>
                        </div>
                        <button pButton icon="pi pi-ellipsis-h" class="p-button-text p-button-rounded"></button>
                    </div>
                </ng-template>
                <ng-template pTemplate="content">
                    <molecule-tabs [(activeTab)]="activeTab" [tabs]="tabs"></molecule-tabs>

                    <app-files-tab-summary *ngIf="activeTab === 'summary'"
                        [selectedFile]="selectedFile"></app-files-tab-summary>
                    <app-files-tab-topics *ngIf="activeTab === 'topics'"
                        [selectedFile]="selectedFile"></app-files-tab-topics>
                    <app-files-tab-emotions *ngIf="activeTab === 'emotions'"
                        [selectedFile]="selectedFile"></app-files-tab-emotions>
                    <app-files-tab-events *ngIf="activeTab === 'events'"
                        [selectedFile]="selectedFile"></app-files-tab-events>
                    <app-files-tab-insights *ngIf="activeTab === 'insights'"
                        [selectedFile]="selectedFile"></app-files-tab-insights>
                    <app-files-tab-notes *ngIf="activeTab === 'notes'"
                        [selectedFile]="selectedFile"></app-files-tab-notes>
                    <app-files-tab-conversations *ngIf="activeTab === 'conversations'"></app-files-tab-conversations>


                </ng-template>
            </p-card>
        </div>

        <ng-template #noFileSelected>
            <div class="col-12 md:col-12">
                <p-card styleClass="h-full">
                    <ng-template pTemplate="title">
                    </ng-template>
                    <ng-template pTemplate="content">
                        <div class="flex flex-column align-items-center justify-content-center py-5">
                            <i class="pi pi-file-o text-6xl text-color-secondary mb-4"></i>
                            <h3 class="text-xl font-medium text-center">El usuario </h3>
                            <p class="text-color-secondary text-center mt-2 mb-0 px-4">
                                No tiene expedientes activos aún.
                            </p>
                        </div>
                    </ng-template>
                </p-card>
            </div>
        </ng-template>
    </div>

</p-dialog>